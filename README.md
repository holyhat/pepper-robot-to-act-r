# Connect ACT-R to a Pepper robot

This is a proof-of-concept for the integration of a cognitive architecture (ACT-R) with the humanoid social robot Pepper preparing a technical basis for a more human-like perception of human interaction partners. The use of cognitive architectures is promising in order to achieve more human-like reactions and behavior in social robots. For example, ACT-R can be used to create a dynamic cognitive person model of a human cooperation partner of the robot. This code contains a sample application programmed in Kotlin for the Android version of the Pepper robot and a simple example ACT-R model *pepper-mood.lsp* in the act-r folder. The ACT-R model is updated with dynamic data from emotion recognition by the robot.

This application shows that a coupling of ACT-R and a social robot is possible and relatively easy to implement without any additional frameworks. The transmission of emotion data recognized by the robot and its evaluation by an ACT-R model as well as the control of the robot by the ACT-R model works.

## System setup for ACT-R and the robot

The standalone version of ACT-R is intended for use here, i.e. the application provided at https://act-r.psy.cmu.edu/. To establish a remote connection from the robot to ACT-R, the remote interface – the *dispatcher* – has to be used, which is implemented by a central command server. The ACT-R core software connects to this dispatcher to provide access to its commands, and the dispatcher accepts TCP/IP socket connections that allow clients to access these commands and provide their own commands for use. 

By default, the standalone version of ACT-R forces the dispatcher to use the localhost IP address of the computer on which it is running for connections. This means that only programs on the same computer can establish a connection, and once ACT-R has been started, this can no longer be changed. To disable this function, the file *force-local.lisp* must be removed from the ACT- R/patches directory before ACT-R is executed. Then it will use the machine’s real IP address for the dispatcher’s connections and setting *allow-external-connections* in the model file will let other machines connect. Another option is to place the model file in the ACT-R/user-loads directory. External connections are then always permitted. The address and port used by the dispatcher is displayed at the top of the ACT-R terminal window. This information must be used on the remote computer or, in our case, in the Pepper application for the connection.

The Pepper application is able to interact directly with the ACT-R model by calling commands. The *run-full-time* command, for example, together with a number of seconds, starts and runs the model for the specified time. The *evaluate* method is used to evaluate commands from the dispatcher. It requires the name of the command to evaluate.

### The ACT-R model

The ACT-R model for this proof-of-concept study uses a goal slot *pepper_out* for sending commands to the robot application using ACT-R productions. This goal slot is evaluated via a permanently running while loop using the *buffer-slot-value* command that gets the value of a slot from the chunk in a buffer of the current model. The *buffer-slot-value* is sent as a string in JSON format via the TCP/IP socket stream. Each evaluation command is assigned a unique ID. This ID is used to identify the correct part of the data in the stream received by the socket. The permanent evaluation of the content of the goal slot *pepper_out* in the robot application is used to create special commands for the robot depending on this slot content, e.g. to execute a certain animation or to make a corresponding utterance.

To transmit information from the robot application to the ACT-R model, the application uses the *overwrite-buffer-chunk* command to copy a chunk into the goal buffer. The model has predefined goal chunks in its *declarative memory*. If a predefined chunk matches the chunk from the robot application, all information from this model chunk is placed in the buffer and can be used to trigger a production in the model.

## Combining emotion recognition and ACT-R

Pepper has the ability to interpret the basic emotion of the human in front of the robot via facial recognition using the *ExcitementState* and *PleasureState* characteristics. The ExcitementState can have the values *calm* or *exited*, the PleasureState the values *positive*, *neutral* or *negative*. These states can be transferred into the basic emotions *neutral*, *content*, *joyful*, *sad* and *angry*.

The idea is to pass these findings on to the ACT-R model, which in turn draws conclusions within the framework of the human-like cognitive architecture and controls the robot application via feedback. The ACT-R model therefore controls the verbal reaction of the robot and/or an animation in the interaction with the human and adapts it to the emotion that has just been recognized. For transmitting a recognized emotion the *overwrite-buffer-chunk* command is used to trigger the right productions of the ACT-R model. How the model handles the information about the person’s current emotion depends on the structure of the ACT-R model with its productions and the nature of the robot application. Predefined goal chunks in the *declarative memory* of the model enable productions to be fired depending on the emotion values transmitted. The robot’s statements, which are controlled via the *Chat* feature of the robot application and saved in dialog topic files, can be influenced depending on the *pepper_out* goal slot value. This can trigger various dialogs, reactions and/or animations of the robot.

![pepper-act-r](https://raw.githubusercontent.com/holyhat/pepper-robot-to-act-r/master/pepper-act-r.png)
